https://viewer.diagrams.net/?tags=%7B%7D&highlight=0000ff&edit=_blank&layers=1&nav=1&title=test_dragram(4)(1).drawio#R7V1rc9s2Fv01ntnujDQEQPDxMXGSpt2k9SaZ7W6%2F7NASbbGVRa1EP9Jfv4BIUOQlSIIvkLSdyYwtWoQo3IODcx8ALsjl3dOPB2%2B%2F%2BRyu%2Fe0FNtZPF%2BTdBcaYYoP94Fe%2Bx1eQ5djxldtDsE6unS98Df7yk4vJjbf3wdo%2F5t4YheE2Cvb5i6twt%2FNXUe6adziEj%2Fm33YTb%2FKfuvVu%2FcOHrytsWr%2F4WrKNNfNWhxvn6Rz%2B43YhPRkbylztPvDm5cNx46%2FAxc4m8vyCXhzCM4t%2Funi79Le890S%2FxfR9K%2Fpo%2B2MHfRSo37B5%2B%2B%2Bdb%2Bg%2Fz4%2FfQ%2Ft1YB78ufv9pkbTy4G3vky98ga0ta%2B%2FtOnhgv97yX3%2F6KC6y1jPXJW%2F1o40hLl8f4Btrb0fGkv03lmaDRk59G30XBnvcBJH%2Fde%2Bt%2BOtHhkr2pk10t2WvEPvVO%2B5jmNwET%2F46bSDbjaJP%2FEPkP2UuJd36ox%2Fe%2BdHhO3uL%2BCuhSxrflMCcGuLCYwY0rri4ySDmfNVLoHqbfsDZmuyXxKANjIslxgW95e%2FWb%2FgoYa9WW%2B94DFb57jqE97s176d3BrfuUxD9O%2FkL%2F%2F0%2F%2FDp7%2FPjVu6fM2959Fy927Kv8%2B%2FRGA4vX8Y0WouLC%2Bd7Tq9zNV%2F4hYB3iH5KLpRY7hveHlV%2BP9sg73PpR1fvM%2BI3%2BOkcORQBkrCsYIWtbce3gb70oeMhTiszcySdchQH7ahl8mTl0IdhE%2FMWTu7IUABrCTr4hF7QTd0yhnRP40m%2FdHo9UhWwEBVj887EtH%2FU%2B7%2FUPBTSz8RqB4b4Nbncc3AwrHEBv%2BagOGL2%2FSf5wF6zX%2FPa3B%2F8Y%2FOVdn5riKNvzXjj1C317Qd%2Fxtu6j8BhPULzpY3QI%2F%2FQvw23IgbkLd7yVm2C7BZd6IBiM8vRiGQVySeedLP5MYyBmsYZiFmPJ9EELckFLg5Asu%2BQuNGEX3n6PjDMtJiFWNQGoEolJraVrg6aWrmuc%2F%2BmlFlQUMjGRYIMuMWXf%2BgNhXWj8zY8YDj%2F8UIQrM9An75rJ18H4o4iiyrEF2SHVuMmH5GSkjDUWrAMsRPJTRy8wEs%2BYNLpw8w2ENzdHfxgzyyRNyRQSW54klm8wizxDKHAkCI4WRsO9QMHNw4vqQoLlygY85WZfIv5UJ%2B3Ax%2Fvmdbx3Hu8E5bFDDF12Ft%2BnSmoc%2F2SsvknsUHDwTobxD%2B8f%2FNg%2BJ%2B0mfHF%2Bx9o7blIhksGCVOBtOWaumA6MglAKlE%2FgDddhFIV3EiRF4V4GuKyCvMCETaSO8y5%2B5D3%2FvndPtzzUsrw7rjx%2FebprfwiO%2FpIJKt5Cd7VpApFgI4kzKxMpxC0Hlqrc%2FEf428LaG0f88PubYxA%2Bfj9cewtCpOP3a%2FIyPESb8Dbcedv356tAYJ7f8ynkHX%2By8B9%2BFH1PYk5c3eftf9akQoTGktQWfyzRpBIBedapeQ%2B4zv%2FtLjyzvq60b5MGawVqMwph0t%2F7nnlDwo7lwhTn1SSyKUBN3GK%2F3GK%2BcotmbiFGXoXYWBuzyCEwmCebjZF1IAxjabIvnyENNssbluawGSlyiTzgaCiSiR5vlxr5iawgT1XdXWrmGyIOaGho79aWoLTo9tiYCUCmfpkOFP5uNh5fEzh%2FrsEzigEKXEn0zJSRzlDRM%2BQ0NCfOmBO1zow8WwODYe5YEr3al4XD6z%2B4BMDGNnYeS4z35f27xdfLL8qJL94I%2BygD2W6VNUWzmYmqOgOU9RgTaOoWN0xoXDvUpMYICufGWfmrlV7vSdCLmCsEOvuXOOxlAscmSUFZyrcXxSN%2B76x4XDeneHhYR3OiUAiZesVjTUrxEJDgM6FQUVU8BHCqSfQqHgHK6eryHEIHc%2BOVgShCJBMBogUUs%2Bm2BKJlE8YH2E3%2F5Zu16NLA5khJJyyLTVbpOKsiGSEvpnlVe4UIggPmVyyR80iC7MGS4VitruEMA1qdkzJejC2xXeJXD2DLBsL9p6uvjYR7j3rdyvTXq17Xodexlc%2BYmSIkOBG9ToVUGCn3YeeTHzX1OOqSacDcB7UURRPFiqKpoxpK1bOIehtqarq2IQpleYmsapyOMfMJX0YH1c9FzW7vR7na5WHSPXTULGI3v6P9YBCJtfrBoOrKdh0MtMY1KBkMjTGM4OeYlZiE7wcYborJBnrj6terFnpDzSNorEDsVwWiWYHAmA0drNqiXcBQlq3oFoqRV0O0CfH1E3vswK6qUkPQ8ETiMwj3FJ9BwIUzTc2BwmIdYLXz7Z6cb14XaPzw0kMpIJhGxk6MElnUt9SYBlryJyldJCKPqDWcP18ADChYXkRkOMA6I2pEKbB68NeL9d1fi014jBaoCQY6LVE8o6809CNP75omD4rPZ1ljIYaPJWsaZSsah1rPSGSB1m5KJJEPvKiK6ZxsoMN03A6hjqVpp0VaadWW3UbhdNAmqp6fpVoDqimJCbSJhVtqEww8OktzEpMUy7YEe5giCyCEyEuZa%2FKSw0LDVeoo2mg47yYT4lTybySujNGYgtrThYUV6ULIxonQBcYguKoYE5XQBWgI8s7QdKHkynyLzYMNolvxMM4i6h96kjyOerKbDXHW3ZfYMRrc4%2FDgxHwUFRBUtiTd6UgGijMU%2BQmmnW4tWBMCbU99ygkjc1pKCQOlREUwpnG5F2xIc4G76FdF6jOVGYL7iOP4hw77YViNC4AJcdxZUZoNJk2zGDzQy2lKMaQUSuo%2BPF8qzleLt0ZGDCwD8TVPlwIiqAvWaubY6aGDCqYdDR0Ky4knVFc6hSIJMaCmMufZfc15IOxpUc1znmz1aTlR0eZznnYP4URo6pPz%2BQvPcaazzLG5bLBwaGHF%2B7Oq%2BhIDb6qE1jZ%2BQUzYENFLaHYRfhorFWflcSoH2wTIhq7KguCx7ZYlioWGFKP35eVdveO06fJb53XZRufZE4FNZWRl1nqXbZiSHaTOkU4rzc6gl5OdSefQdHlVce2q3vQMlUUoy0WyeiUIF8ms43kBAY7VsnokoMd4urqqFwEiiui8NkemBGyOPHrYW5T9K4JKPYiXel7qPlCfnpczXRRA58m0Rw4T0qLz9C7chQ%2BBt3tJOwsTuALPVRubwxG%2BwoZMojT7%2BBicitHf1gD6EEZeUh3Oa4j66ThREJc6W7It34nWrisvN2H04FpJqeRLQTbI5lNDUmoiq2oczj5FvyNL39iak9rMjKlKT7iBUMBgIaZkihhMfMq3RnQLttC69LLZVuj9FgOpHpUgAhn9xSe6r9%2B%2B%2BvVKXcyfWxlmQZWV7Y%2FXBVVaNpmEZZ%2FTWtEthsxQEsfti5BhPzrFftQqcKxixiwbscEngTOnSbQPI1Gj1khIivbBrKS0HUq02rP3IJc7F5fsB45%2FOPGPkk3w7tfJTWb6thdiZriJpYUk4siSmLmP8KlUHIkHmsSe3NXKSHsq0lJdeSGiIoOrJ0Wb0tnZVNuG6uo27X0fhW50rLR38DfvkEQ71Qsld370GB7%2BDHa3i1V0s16go39gjLZ4iDxt4c%2F0yA9LXfEnU88pw3npGMaswulwt4BFevBXZiZwJROBO9h83%2F8KmpIyFIN22lY0txon5Y0uRCEnUVeRKKyJbQnggn2y4Up%2B5XU0oAIAKW7w0iK%2FLzeABH%2Fj7PPT4GzM%2FsFZKTjqZzFnWspkMns3tbXpcLVE6jZVJRw9ysRWchQ95mTtA2%2BxDx7CqJWuUFERZMnPjGuoO0y8xKjZEo%2F5CA2YGVwgybkJQwkNOQdMpr5wghygWvwqkrlT4XVn7jYdcK5WtamtuiBbE6%2FLUvgFNtwHO%2FY0O16FdQzWPO7fcWGVOnXj5emEnGZcbzKuV7%2BJf%2BVLLloyy7PmwPrQCdDK%2BpWipRpNl4wFgp2nEUSkEYgwXs4LCPAQyPHjDLZS2fa%2FglUUHgLdSCjfg2yCpkwrukYzpdJOF5%2FDjXd3vx50GlCPGvJOnhuZG1MzvPj8asO%2FiZgw4Dk6zZqg4eYmmMwaDKMTulO%2B6cNNeAoonnvM%2Bt99KP6wiFOwb3gQ39k%2Fxb2e%2FB3aQWqZuPXyhf7gIWIv4vwZpIePq0VYi4fY%2BaxrjhueweHQ9%2B44qpLGjFjFEnuJOWyNxZcLvpTAZhggbxC2Gfq5nCFvMB7hyYON9JHTx2LPu0%2Bf9%2FQTnZ7b5cUfThy6yT76qGb46aPsyzDDVH2lBWvTcA0eymcDdgpfQ26Tuq%2FxKX7BD3DLmAdz8xDC16PO9Nvxc6eenZFozkgmNxKllE7me0gNQcsMofFxO9t%2BfDlgi9k%2F1YYSR9%2BU6QFzOEGgtO2vuugq3Pr3vyu%2F9SbYqXse53bb1TCYHOa8elF93Rifzwt3zUGHYl7qlwWe7AA3vTpUaSOWDhZu6ouYDUNLszI%2F2K1zYUoqGfWaXykNqdH8tJn55xeXIGREDMhX%2BqhAIPGvFucSOR1g4MJsidTjVDmnqP1zzjWBwXRMHlxIcpqB3rS1CrZ%2Bef9t8fXrx4XRIKbUEVspThpsbXKq1p%2FbOQYFSMikrlZIKOncFBIN5ve%2BIIHVbwLzT%2F2HIJ5GveRKgP2IgwIzwhKZGpaUxGuKpQYDty8smQ3pJRuCmAUk0NQgMS1BmyEV9btmBQAqFl5NRXJYUwWAulszawBgySbYWgGgVDMzAgCoeoBr1gAgdGQAyAosQD%2F1sSanej1Oac%2FWrqGZ1g6tC2TmZ3gC7aa6NGYBl2ubcBn2wGtjRKBlXGAMWh9d5XFlS2nl%2FYMmhjxcoi0bIw9swFZYGD408JRCbMkZC%2BdjFhpMLlR9RpphzLTgeMo2UNUbMx3sKIUGWzmficTWxCSSjZGqGGcqREIsMP7hxKNMJHBjNQT3aByaSWQRjxcwhakCD08LeMgBwLNbayeQNsJYM%2FAGO2%2Bhwdkxk4XdxCQ7lDutUTc26GSxHAA6sVnYNtj9WQU30fVWFSCaGDAtIe5qLWzUuEXqJFHX0tD2Kt2E9VysAzmD9fineFPDoTauKlq7GmxQlmJjFe52TNQmn3KRDINSuWosCc7ZgfQ0m6BcqwuE802ENzdHf5hdJZQcmDTRYnWIrqWAsRq6NBjfzDVrDw%2BK01gUJpfvmgIlE9zVRlolJVR3vfyc1unQROwaIA4faH1CqguYR%2B%2B8gosR3Zvg4D96vJnifvWsxWB%2F5JODEAerbXjPR2vN6O5hMBMDF8audAdKe6ixi2fTV%2BmUK5xpWebIKvad1QPvffj58%2B6z%2B7NH%2F%2Ffx49r%2B49Lb3alXwtH%2FrsK7g7f2kfqZK%2FsDG8dR%2BQ3N5qFSqVIwSEXv2yVqMdv9tNj9prmkAxmgiN1UDoiH7TxXd%2Bs0OFdbWF8kUtplSuVUaS82qFXSLqL6NYw9tmFK92tOagEm0GcIzOuj91kxyJTps2kQAOyz0QlAqd4l7UZ36omifq2j05WSSwqZplBxpY5MU0cdw6nq2zrlwqmKGwkDJ6fWtaqa8bOeVTkzTCaOb7WvgYD0AVsqcaXKTwgt%2ByBQlWMlmaozmOMm2zpqcrQXBdxAaG%2BJ3DajpEe0SyoxyrXDZNBu2%2B7SaRk6KGoMSWNDYd62dWC%2BqMCnJ%2FRA%2FYSjsUhX3mn957E7JQdVRnftqI2RMN6wLUF%2F8zHrgoYU56jeRlSzXHNy0EgpMlQt%2FAwMB1uisKXGTNu7bRVSut3rCKYlfCtTarWsYo2sBQCiYAlAgwoWEG7sjM2Gg2BYFSBbddDXhNamvK%2FpjFYB0smAr0NlhAlagjmEgac0GRrG2cJftcSqeWa1Fw8JOYq0GJ9PWoRmM8w1JxdE8ye12siohp5jV94wDB3hIh1F%2FnYXH3KU3VhBAkot5TjKVTZ5GFUMrnLvx1gappNPNYpUX1uG6rXkRh4qGPXQj3bVwFPnDFJStzU0Z8AKP3Eoa0XQxJC7BOUrXEzS8QZDAy2Rotsf79d3Sqofo%2Fs1Mz6TUmaXDfyMxS%2FfngexkZKAQobYbLEzeE%2FEJp4cyKMBec4ahec6xo%2FVV%2BmMwnMl2ZLuC%2FIAaThw%2BUuJIG9BmagxZYI7HKOOAd2ON9hJVHVYyiwquQaUGe8YKijztG9wpr6WvIn3Q342fFkSKznzJXKcfElkP3QJEibg%2FgHJc9QThPIRN7tdyM3WmGzW51x2K%2BkqlrvGQ%2F6BH%2B1h7JnJzoLoWYxbp3bc2hRsmzh5B86cTMhn2BPbXoQL5%2BK8zKYuqtYKhRtIjbiwaOUNw4gLs5i7ljONyB%2FPnWnM2lCRRQuHP02eaSZzNmSbQNFEJUA%2FPlQLxwc3dnzAHQ6uoxrS9YakF4flpuKRZ%2BcQdsbViR2b58FOdq0OwjZcBNqNnZ7EbJO%2FYziyouPIIkE96KKBwJGLKaytXFCzKpItKAfcopr%2Bby6wYNLecmsEFryhLg9nIVJ1wzAkRlUFFnomAovWCiwHW3A16dQFFpXvWzBhgdVmZfQcKauFviKN9RVUP25DVw7cMBDTFIsm28aJEQXn4sVnzj2jQDEtKbDPJNZcAwSc%2BtnEA86fA5LWOIm1%2FraxmyRrDZRZo0BnIULoknETorbjmjYRU2bvtZIwo%2BfW%2BYIU46obBiK3yiTYeTG%2BnNwQPDbv%2BfBYbcLLMA1QINDTZkSWtNXhaQ0pnYTOzyFtsZ13uxPskJE76WEmC2XBwKemJbZ1yFT3Ou5SsgPE%2BWr%2Fq%2BZHldotM5pJSGCMvImrOnF1ldvdrFomTvNuMKXPxAs2q%2FUlr9sSQJ%2Bu1yuw9Xow3BQOhutG97AIXc72WpeA4lFrVzJh3Jm4KKpMj0qKKboKPofCwAnYwkx9MQ6yLdCUlW%2BqL%2FfGAYs1xDOXL9aAqzvMGneo8F2a3wEiUAMtCCmrKUoiQ9x1OvEqsZc4rgr8ciGKjPLRoFM7z8aFwrW1RwbcRrGflNsC3DFgJGg6VYKtwtca9bQI9U61PAAmsay6mmUKTu%2BxdCzzoErK8f4Y7G4vzhFnZRVWkkFrr8hmSVy0lrgoAbUCuBfiEkokLVTTxWPSbYlfj%2FvU6UfYBuAfjYeXy0eBvPRn0sskQbhIoxMhznOYanYWzlaOVZdqBTsEgBsGmt6Ke%2FqVpVpzzJAkJJJFil%2FSaes5y2taAqTzLIVFRVi%2FFW0LF6TMBpyXlM4cfrmnI3SbcihcdafxeFF5cLd8x9Vr0XPfNj57x9UhXPnHY2V3X7ft7D76FiFYbSzZgj1dWCnb4qVB77KXhzCMsmOPfanN53DNKe39%2FwE%3D

sudo apt-get install nftables
sudo nft list tables
sudo nft add table ip BH1
sudo nft list tables
sudo nft flush table ip BH1
sudo nft delete table ip filter
sudo nft list tables
sudo nft add chain ip BH1 input { type filter hook input priority 0\; policy accept\; }
sudo nft list ruleset
sudo nft add chain ip BH1 output { type filter hook output priority 0\; policy accept\; }
sudo nft list table ip BH1
sudo nft insert rule ip BH1 input tcp dport 22 accept
sudo nft insert rule ip BH1 input tcp sport 22 accept
sudo nft insert rule ip BH1 output tcp dport 22 accept
sudo nft insert rule ip BH1 output tcp sport 22 accept
sudo nft list table ip BH1
sudo nft add rule ip BH1 input tcp dport { 6010,6011,6012 } ct state { new, established } accept
sudo nft add rule ip BH1 input tcp sport { 6010,6011,6012 } ct state { new, established } accept
sudo nft add rule ip BH1 output tcp dport { 6010,6011,6012 } ct state { new, established } accept
sudo nft add rule ip BH1 output tcp sport { 6010,6011,6012 } ct state { new, established } accept
sudo nft list table ip BH1
sudo nft add chain ip BH1 input { type filter hook input priority 0\; policy drop\; }
sudo nft add chain ip BH1 output { type filter hook output priority 0\; policy drop\; }
sudo nft add rule ip BH1 input ip saddr 172.16.82.112 drop
sudo nft add rule ip BH1 output ip daddr 172.16.82.112 drop
sudo nft list table ip BH1
sudo nft insert rule ip BH1 input ip saddr 10.10.0.40 accept
sudo nft insert rule ip BH1 output ip daddr 10.10.0.40 accept
sudo nft list table ip Bh1 -ann
sudo nft add rule ip BH1 input position 21 ip saddr 172.16.82.112 drop
sudo nft add rule ip BH1 output position 21 ip daddr 172.16.82.112 drop
sudo nft delete rule ip BH1 input handle 19
sudo nft delete rule ip BH1 output handle 20
sudo nft add rule ip BH1 input ct state invalid drop
sudo nft add rule ip BH1 input ip frag-off != 0 drop
sudo nft add rule ip BH1 input tcp flag syn limit rate 10/second accept
sudo nft list table ip BH1 -ann
sudo nft list ruleset > nftable.rules
ls nftable.rules | cat
sudo nft add chain ip BH1 input { type filter hook input priority 0\; policy accept\; }
sudo nft add chain ip BH1 output { type filter hook output priority 0\; policy accept\; }
sudo nft list table ip BH1
sudo nft flush table ip BH1
sudo nft -f nftable.rules
